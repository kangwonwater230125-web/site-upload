<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>강원수도건설 현장관리 시스템</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    h1 { text-align: center; margin-bottom: 30px; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, select { width: 100%; padding: 8px; margin-top: 5px; }
    button { margin-top: 25px; padding: 12px; width: 100%; font-size: 16px; }
  </style>
</head>
<body>

<div style="text-align:center; margin-bottom: 10px;">
  <img src="/logo.png" alt="강원수도건설 로고" style="height:80px;">
</div>

<h1>강원수도건설 현장관리 시스템</h1>

<form id="uploadForm">
  <label>공사 날짜</label>
  <input type="date" name="workDate" required />

  <label>공종</label>
  <select name="workType" required>
    <option value="관파">관파</option>
    <option value="신설">신설</option>
    <option value="함이설">함이설</option>
    <option value="함신설">함신설</option>
    <option value="계량팀">계량팀</option>
    <option value="마상팀">마상팀</option>
    <option value="기타">기타</option>
  </select>

  <label>주소</label>
  <input type="text" name="address" placeholder="주소 입력" />

  <label>업로더 이름</label>
  <input type="text" name="uploader" placeholder="이름 입력" required />

  <label>사진 선택</label>
  <input type="file" name="photos" multiple required />

  <button type="submit">사진 업로드</button>
</form>

<script>
  const form = document.getElementById('uploadForm');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(form);

    // ✅ 현재 접속한 서버(Render / 로컬 자동 인식)
    const API_BASE = window.location.origin;

    const response = await fetch(`${API_BASE}/upload`, {
      method: 'POST',
      body: formData
    });

    if (response.ok) {
      alert('업로드 완료!');
      form.reset();
    } else {
      const msg = await response.text().catch(() => '');
      alert('업로드 실패\n' + msg);
    }
  });
</script>
